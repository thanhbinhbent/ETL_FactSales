<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="4/13/2023 11:00:27 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="THANHBINHPC"
  DTS:CreatorName="THANHBINHPC\THANH BINH"
  DTS:DTSID="{9741B10F-2976-4CDF-B134-521A8E0FBA9D}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="16.0.5035.3"
  DTS:LocaleID="1033"
  DTS:ObjectName="Package1"
  DTS:PackageType="5"
  DTS:VersionBuild="5"
  DTS:VersionGUID="{ED8CBD5A-E822-4A39-8175-291FF04F13AB}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[THANHBINHPC\MSSQLSERVER01.SalesDW]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{C066D8A3-B2B9-4D71-87F0-C25E669B1D11}"
      DTS:ObjectName="THANHBINHPC\MSSQLSERVER01.SalesDW">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectRetryCount="1"
          DTS:ConnectRetryInterval="5"
          DTS:ConnectionString="Data Source=THANHBINHPC\MSSQLSERVER01;Initial Catalog=SalesDW;Provider=SQLNCLI11.1;Integrated Security=SSPI;Application Name=SSIS-Package1-{C066D8A3-B2B9-4D71-87F0-C25E669B1D11}THANHBINHPC\MSSQLSERVER01.SalesDW;Auto Translate=False;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:Variables />
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\CreateDimDate Table"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{44ED7F9E-4416-4C6F-BC5F-1EC5B42FE6DD}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="CreateDimDate Table"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2022; © 2022 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{C066D8A3-B2B9-4D71-87F0-C25E669B1D11}"
          SQLTask:SqlStatementSource="-- Delete time dimension if it already exists.&#xA;IF Exists(Select Name from sysobjects where name = 'DimTime')&#xA;BEGIN&#xA;    Drop Table DimTime&#xA;END&#xA;GO&#xA;&#xA;-- Standard options for creating tables&#xA;SET ANSI_NULLS ON&#xA;GO&#xA;&#xA;SET QUOTED_IDENTIFIER ON&#xA;GO&#xA;&#xA;-- Create your dimension table&#xA;-- Adjust to your own needs&#xA;Create Table dw.DimTime&#xA;(&#xA;    DateKey int IDENTITY (1,1) PRIMARY KEY CLUSTERED,&#xA;    Date datetime,&#xA;    DateString varchar(10),&#xA;    Day int,&#xA;    DayofYear int,&#xA;    DayofWeek int,&#xA;    DayofWeekName varchar(10),&#xA;    Week int,&#xA;    Month int,&#xA;    MonthName varchar(10),&#xA;    Quarter int,&#xA;    Year int,&#xA;    IsWeekend bit,&#xA;    IsLeapYear bit&#xA;)&#xA;&#xA;-- Declare and set variables for loop&#xA;Declare&#xA;@StartDate datetime,&#xA;@EndDate datetime,&#xA;@Date datetime&#xA;&#xA;Set @StartDate = '2000/01/01'&#xA;Set @EndDate = '2022/12/31'&#xA;Set @Date = @StartDate&#xA;&#xA;-- Loop through dates&#xA;WHILE @Date &lt;=@EndDate&#xA;BEGIN&#xA;    -- Check for leap year&#xA;    DECLARE @IsLeapYear BIT&#xA;    IF ((Year(@Date) % 4 = 0) AND (Year(@Date) % 100 != 0 OR Year(@Date) % 400 = 0))&#xA;    BEGIN&#xA;        SELECT @IsLeapYear = 1&#xA;    END&#xA;    ELSE&#xA;    BEGIN&#xA;        SELECT @IsLeapYear = 0&#xA;    END&#xA;&#xA;    -- Check for weekend&#xA;    DECLARE @IsWeekend BIT&#xA;    IF (DATEPART(dw, @Date) = 1 OR DATEPART(dw, @Date) = 7)&#xA;    BEGIN&#xA;        SELECT @IsWeekend = 1&#xA;    END&#xA;    ELSE&#xA;    BEGIN&#xA;        SELECT @IsWeekend = 0&#xA;    END&#xA;&#xA;    -- Insert record in dimension table&#xA;    INSERT Into dw.DimTime&#xA;    (&#xA;    [Date],&#xA;    [DateString],&#xA;    [Day],&#xA;    [DayofYear],&#xA;    [DayofWeek],&#xA;    [Dayofweekname],&#xA;    [Week],&#xA;    [Month],&#xA;    [MonthName],&#xA;    [Quarter],&#xA;    [Year],&#xA;    [IsWeekend],&#xA;    [IsLeapYear]&#xA;    )&#xA;    Values&#xA;    (&#xA;    @Date,&#xA;    CONVERT(varchar(10), @Date, 105), -- See links for 105 explanation&#xA;    Day(@Date),&#xA;    DATEPART(dy, @Date),&#xA;    DATEPART(dw, @Date),&#xA;    DATENAME(dw, @Date),&#xA;    DATEPART(wk, @Date),&#xA;    DATEPART(mm, @Date),&#xA;    DATENAME(mm, @Date),&#xA;    DATENAME(qq, @Date),&#xA;    Year(@Date),&#xA;    @IsWeekend,&#xA;    @IsLeapYear&#xA;    )&#xA;&#xA;    -- Goto next day&#xA;    Set @Date = @Date + 1&#xA;END&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="178.4,41.6"
          Id="Package\CreateDimDate Table"
          TopLeft="61.4285724746937,68.8235303769887" />
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>